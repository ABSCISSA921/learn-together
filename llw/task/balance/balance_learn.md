# 整体情况

| 功能             | 完成情况 | 说明 |
| ---------------- | -------- | ---- |
| 平衡小车URDF     |  已完成  | 在之前差速小车URDF基础上修改得来，调整了质量和对应的惯性矩阵 |
| 平衡小车关节驱动 |   已完成   | 通过给两边轮子加载力矩控制器实现 |
|                  |          |      |
| ...              | ...      | ...  |

## 功能细节

### 平衡小车URDF

![](../pic/balance_urdf_01.png)
如图所示，给平衡小车URDF设置了合适的惯性矩阵。

**遇到的问题** 由于当前车体质量分布情况，以及gazebo环境较理想，导致即使不加载控制器，小车也不会跌倒。

**我的解决方法** 通过加载时添加初始姿态参数，使小车一开始就处于倾斜状态。实践中，在让轮子转动后再停止，小车会进入倾倒状态。
```xml
  <node name="urdf_spawner" pkg="gazebo_ros" type="spawn_model" respawn="false" output="screen"
        args="-urdf -model balance_car -param robot_description -x 0 -y 0 -z 0.2 -P 0.1" />
```

### 平衡小车关节驱动

![](../pic/balance_urdf_02.png)

这是一张运动中的截图。可从图中轮子坐标轴看出，轮子能够转动。

实现方式是通过给左右轮子分别加载力矩控制器，然后发布力矩指令即可。

**遇到的问题** 一开始发布力矩指令后，小车开始高速旋转，难以控制。

**我的解决方法** ：
- 首先认为是车身质量设置过低导致，调整质量并同步让ai生成惯性矩阵，问题仍存在。
- 后来发现是没有设置动力学参数，给轮子添加了适当的粘性阻尼和静摩擦力后，问题解决。
```xml
<dynamics damping="0.1" friction="0.1"/>
```

---
